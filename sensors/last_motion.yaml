################################################################################
### Last motion: state last Hue motion sensor with detected motion           ###
### Observed instances: Treppenhaus, Flur, Eingang, Esszimmer                ###
################################################################################

  - platform: template
    sensors:
      hue_motion_last_motion:
        friendly_name: 'Hue Motion - Last Motion'
        value_template: >-
          {% set sensors = [binary_sensor.hue_motion_eingang_motion, binary_sensor.hue_motion_esszimmer_motion, binary_sensor.hue_motion_flur_motion, binary_sensor.hue_motion_treppenhaus_motion] %}

          {% for sensor in sensors %}
            {% if as_timestamp(sensor.last_changed) == as_timestamp(sensors | map(attribute='last_changed') | max) %}
              {{ sensor.name }}
            {% endif %}
          {% endfor %}
